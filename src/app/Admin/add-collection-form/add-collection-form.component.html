<simple-notifications></simple-notifications>
<div class="container-fluid form-container mx-auto">
  <div class="form-page container">
    <header class="p-2" style="position: relative; border-bottom: 1px solid #7A1C1C;">
      <nav class="row">
        <div class="col text-center mx-auto">
          <a [routerLink]="['home']">
            <picture>
              <img src="../../../assets/logo.svg" style="max-height: 75px;" class="img-responsive" alt="chronowiz">
            </picture>
          </a>
        </div>
      </nav>
      <div style="position: absolute; cursor: pointer; top: 29px; right: 15px;" class="float-right" (click)="logout()">
        <img src="../../../assets/logout.svg" style="max-height: 32px;" class="img-responsive" alt="logout">
      </div>
    </header>

    <div class="my-5">
      <h1> Collections </h1>
    </div>

    <div class="row">
      <div class="col">
        <button type="button" class="btn secondry-btn btn-lg" (click)="openWatchForm()">Watch Form</button>
      </div>
      <div class="col">
        <button type="button" class="btn primary-btn btn-lg" (click)="openCollectionForm()">Collection Form</button>
      </div>
      <div class="col">
        <button type="button" class="btn secondry-btn btn-lg" (click)="openBrandForm()">Brand Form</button>
      </div>
    </div>

    <div>
      <br />
      <h3>Mode</h3>
      <br />
      <label class="form-check-inline">
        <input class="form-check-input" type="radio" (change)="collectionForm.reset(); newCollection();" name="mode" value="create"
          [(ngModel)]="mode">
        Create
      </label>
      <label class="form-check-inline">
        <input class="form-check-input" type="radio" (change)="collectionForm.reset(); newCollection();" name="mode" value="update"
          [(ngModel)]="mode">
        Update
      </label>
      <label class="form-check-inline">
        <input class="form-check-input" type="radio" (change)="collectionForm.reset(); newCollection();" name="mode" value="delete"
          [(ngModel)]="mode">
        Delete
      </label>
    </div>

    <form #collectionForm="ngForm">

      <div *ngIf="mode != 'create'">
        <br />
        <h3>Select Collection</h3>
        <br />
        <div>
          <div class="row">
            <div class="col">
              <div class="form-group">
                <label for="selectionBrand">Brand</label>
                <select type="text" (change)="onSelectionBrandSelected($event.target.value)" class="form-control" id="selectionBrand"
                  name="selectionBrand">
                  <option value=""></option>
                  <option *ngFor="let selectionBrand of brands" [value]="selectionBrand?._id">{{selectionBrand?.name}}</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="selectionCollection">Collection</label>
          <select type="text" (change)="onSelectionCollectionSelected($event.target.value)" class="form-control" id="selectionCollection"
            name="selectionCollection">
            <option value=""></option>
            <option *ngFor="let selectionCollection of selectionCollections" [value]="selectionCollection?._id">{{selectionCollection?.name}}</option>
          </select>
        </div>
      </div>

      <div class="form-group" *ngIf="(mode == 'create') || (collection.brandObject)">
        <br />
        <h3>Collection Details</h3>
        <br />
        <div class="form-group">
          <label for="brandObject">Brand</label>
          <select [disabled]="mode == 'delete'" type="text" class="form-control" id="brandObject" required [(ngModel)]="collection.brandObject"
            name="brandObject" #brandObject="ngModel">
            <option value=""></option>
            <option *ngFor="let brand of brands" [value]="brand?._id">{{brand?.name}}</option>
          </select>
          <div [hidden]="brandObject.valid || brandObject.pristine" class="alert alert-danger">Brand is required</div>
        </div>

        <div class="form-group">
          <label for="name">Collection Name</label>
          <input [disabled]="mode == 'delete'" type="text" class="form-control" id="name" required
            [(ngModel)]="collection.name" name="name" #name="ngModel">
          <div [hidden]="name.valid || name.pristine" class="alert alert-danger">Collection Name is required</div>
        </div>

      </div>
      <br />
      <div style="text-align: center"  *ngIf="(mode == 'create') || (collection.brandObject)">
        <div class="row m-1">
          <div class="col-6">
            <button type="submit" class="btn primary-btn btn-lg" (click)="onSubmit();" [disabled]="(!collectionForm.form.valid || loading) && (mode != 'delete')">
              {{loading? 'loading..' : mode }}</button>
          </div>
          <div class="col-6">
            <button type="button" class="btn btn-lg secondry-btn" (click)="newCollection(); collectionForm.reset(); ">Clear</button>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
